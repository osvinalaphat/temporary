<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="/static/style.css">
    </head>

    <body>
        <!-- Signup Form -->
        <input type="email" id="signup-email" placeholder="Email">
        <input type="password" id="signup-password" placeholder="Password">
        <button onclick="signup()">Sign Up</button>

        <!-- Login Form -->
        <input type="email" id="login-email" placeholder="Email">
        <input type="password" id="login-password" placeholder="Password">
        <button onclick="login()">Log In</button>



        <h1 id="user">Portfolio Title</h1>
        <p id="biog" style="white-space: pre-wrap;"></p>

        <!-- Change text options-->
        <div id="write" class="pops">
            <button id="nameCloser" onclick="nameCloser()">X</button>
            <div id="writeheadbar">Drag Menu</div>
            <br>
            <div id="form1">
                <label id="nameLabel">Type your name:</label>
                <br>
                <input type="text" id="nameText" placeholder="Name Here" /><br>
                <button id="nameSub">Submit</button>
            </div>
            <br>
            <br>

            <div id="form2">
                <label id="biogLabel">Type your Biography:</label> <br>
                <textarea id="bio" placeholder="Biography Here" rows="8" cols="20"></textarea><br>
                <button id="biogSub">Change Biography</button>
            </div>


        </div>

        <!--Color settings-->
        <div id="colors" class="pops">

            <div id="colorsheadbar">Drag Menu</div>
            <button id="colorCloser" onclick="colorCloser()">X</button>

            <div id="changeNameColor">
                <label>Title color</label>
                <select id="nameColorDrop" onchange="changeNameColor(value)">
                    <option></option>
                    <option value="#dd5555">Red</option>
                    <option value="#dd7733">Orange</option>
                    <option value="#ffee45">Yellow</option>
                    <option value="#aaeeaa">Green</option>
                    <option value="#5555dd">Blue</option>
                    <option value="#aa22dd">Purple</option>
                </select>
            </div>

                <div id="bgColor">
                    <br>
                    <label>Background color</label>
                    <select id="colorDrop" onchange="changeColor(value)">
                        <option></option>
                        <option value="#dd5555">Red</option>
                        <option value="#dd7733">Orange</option>
                        <option value="#ffee45">Yellow</option>
                        <option value="#aaeeaa">Green</option>
                        <option value="#5555dd">Blue</option>
                        <option value="#aa22dd">Purple</option>
                    </select>
                    <br>
                </div>

                <div id="biogColor">
                    <br>
                    <label>Biography color</label>
                    <select id="biogColorDtop" onchange="changeBiogColor(value)">
                        <option></option>
                        <option value="#dd5555">Red</option>
                        <option value="#dd7733">Orange</option>
                        <option value="#ffee45">Yellow</option>
                        <option value="#aaeeaa">Green</option>
                        <option value="#5555dd">Blue</option>
                        <option value="#aa22dd">Purple</option>
                    </select>
                    <br>
                </div>
        </div>

        <!--Change margins-->
        <div id="margin"class="pops">
            <button id="marginCloser" onclick="marginCloser()">X</button>
            <div id="marginheadbar">Drag Menu</div>
            <div>
                <button id="titleRight" value="up" onclick="moveName(value)">/\</button>
                <button id="titleLeft" value="left" onclick="moveName(value)"><</button>
                <p>Move Title</p>
                <button id="titleUp" value="right" onclick="moveName(value)">></button>
                <button id="titleDown" value="bottom" onclick="moveName(value)">\/</button>
            </div>
            <div>
                <div>
                    <button id="biogRight" value="up" onclick="moveBiog(value)">/\</button>
                    <button id="biogLeft" value="left" onclick="moveBiog(value)"><</button>
                    <p>Move Biography</p>
                    <button id="biogUp" value="right" onclick="moveBiog(value)">></button>
                    <button id="biogDown" value="bottom" onclick="moveBiog(value)">\/</button>
                </div>
            </div>
        </div>


        

        <!--MAIN MENU BAR-->
        <div id="menu">
            <div id="menuLoadOut">
                <button id="writeForm" class="menuButtons" onclick="writePop()">Change Text</button>
                <button id="colorForm" class="menuButtons" onclick="colorsPop()">Change Coloring</button>
                <button id="marginForm" class="menuButtons" onclick="marginPop()">Change Margins</button>
            </div>
            <button id="menuArrow" onclick="showMenu()">\/</button>
        </div>

        <button onclick="saveAllUserData()">Save My Portfolio</button>


        <script src="/static/middle.js"></script>

        
        <script src="https://www.gstatic.com/firebasejs/10.10.0/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/10.10.0/firebase-auth-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/10.10.0/firebase-analytics-compat.js"></script>
        
        <script>
            // Your web app's Firebase configuration
            const firebaseConfig = {
                apiKey: "AIzaSyBScCHQRvwumXBR9Ef1Z0cdhdmc9BexuG4",
                authDomain: "portfolio-d5c42.firebaseapp.com",
                projectId: "portfolio-d5c42",
                storageBucket: "portfolio-d5c42.appspot.com",
                messagingSenderId: "893202911708",
                appId: "1:893202911708:web:17c379569b9dee2dbdff19",
                measurementId: "G-BWKCMW42G6"
            };

            // Initialize Firebase
            const app = firebase.initializeApp(firebaseConfig);
            const auth = firebase.auth();
            const analytics = firebase.analytics();

            // SIGNUP
            window.signup = function () {
                const email = document.getElementById("signup-email").value;
                const password = document.getElementById("signup-password").value;

                auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    alert("Signup successful!");
                    console.log(userCredential.user);
                })
                .catch((error) => {
                    alert("Error: " + error.message);
                });
            };

            // LOGIN
            window.login = function () {
                const email = document.getElementById("login-email").value;
                const password = document.getElementById("login-password").value;

                auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    alert("Login successful!");
                    firebase.auth().onAuthStateChanged(user => {
                        if (user) {
                            window.currentUID = user.uid; // Store the user's UID
                            fetchUserData(user.uid); // Fetch user data on login
                            function fetchUserData(uid) {
                            fetch(`/my-page?uid=${uid}`, {
                                method: "GET",
                                headers: {
                                "Content-Type": "application/json"
                                }
                            })
                            .then(response => response.json())
                            .then(data => {
                                if (data) {
                                document.getElementById("user").textContent = `${data.title}'s Portfolio`;
                                document.getElementById("biog").textContent = data.biog;
                                document.body.style.backgroundColor = data.background_color;
                                window.user.style.color = data.title_color;
                                window.biog.style.color = data.biog_color;
                                }
                            })
                            .catch(error => console.error("Error fetching user data:", error));
                            }

                        }
                        });
                })
                .catch((error) => {
                    alert("Error: " + error.message);
                });
            };
            
        </script>

    </body>
</html>
